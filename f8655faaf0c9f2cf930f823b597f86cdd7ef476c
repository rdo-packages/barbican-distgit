{
  "comments": [
    {
      "key": {
        "uuid": "b35a943d_4fd349a9",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 13,
      "author": {
        "id": 588
      },
      "writtenOn": "2020-05-07T20:07:42Z",
      "side": 1,
      "message": "I\u0027m not sure I understand the reasoning behind this?\n\nThe Thales backend for Barbican is optional, so I\u0027m not sure that the nfast user and group need to be created every time barbican-common is installed? I think it does make sense to add the barbican user to the nfast group if the group is already present.\n\nThe Kolla change was added to support the Thales backend in the TripleO container image for Barbican.  In the current implementation, we need to ensure that the nfast GID and UID match both in the controller host and inside the barbican containers, so I disagree that it should not be managed in the Dockerfile.",
      "range": {
        "startLine": 12,
        "startChar": 62,
        "endLine": 13,
        "endChar": 38
      },
      "revId": "f8655faaf0c9f2cf930f823b597f86cdd7ef476c",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "71e64682_55daa908",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 13,
      "author": {
        "id": 62
      },
      "writtenOn": "2020-05-07T20:39:18Z",
      "side": 1,
      "message": "ok so what you\u0027re saying is that we should add the barbican user into the nfast group only in the tripleo barbican container?\nWe\u0027re rebuilding tripleo containers without kolla and we don\u0027t create users / groups in the Dockerfile when possible (like Kolla did) because they\u0027re already created by the rpms.\nPlease tell us how and where you want this group/user to be done.",
      "parentUuid": "b35a943d_4fd349a9",
      "range": {
        "startLine": 12,
        "startChar": 62,
        "endLine": 13,
        "endChar": 38
      },
      "revId": "f8655faaf0c9f2cf930f823b597f86cdd7ef476c",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "be21079e_d288b27e",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 13,
      "author": {
        "id": 588
      },
      "writtenOn": "2020-05-08T15:25:31Z",
      "side": 1,
      "message": "Ah, I did not know about the effort to get TripleO to build containers without Kolla.\n\nI discussed this change with Ade, and we don\u0027t have a preference on whether the nfast user and group gets added here or in the container, however, the GID and UID MUST match to what THT is setting in the Controller nodes:\n\nhttps://opendev.org/openstack/tripleo-heat-templates/src/branch/master/environments/barbican-backend-pkcs11-thales.yaml#L27-L28\n\nSo, we have two options:\n\n1. Change this patch to use nfast GID 42481 and nfast UID 42481, or\n\n2. Make sure that the new non-Kolla image creates the nfast user with those same UID and GID values before installing this RPM.",
      "parentUuid": "71e64682_55daa908",
      "range": {
        "startLine": 12,
        "startChar": 62,
        "endLine": 13,
        "endChar": 38
      },
      "revId": "f8655faaf0c9f2cf930f823b597f86cdd7ef476c",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f190f2c2_ba7aad9c",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 13,
      "author": {
        "id": 62
      },
      "writtenOn": "2020-05-08T15:42:19Z",
      "side": 1,
      "message": "\u003e So, we have two options:\n \u003e \n \u003e 1. Change this patch to use nfast GID 42481 and nfast UID 42481, or\n \u003e \n \u003e 2. Make sure that the new non-Kolla image creates the nfast user\n \u003e with those same UID and GID values before installing this RPM.\n\nYour choice. Solving it at the rpm level is of course easier but I can understand if you prefer the 2) option. Either way please let me know.",
      "parentUuid": "be21079e_d288b27e",
      "range": {
        "startLine": 12,
        "startChar": 62,
        "endLine": 13,
        "endChar": 38
      },
      "revId": "f8655faaf0c9f2cf930f823b597f86cdd7ef476c",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7",
      "unresolved": false
    }
  ]
}